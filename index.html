<html>
<head>
<title>online logo interpreter in javascript</title>
<!-- $Id$ -->
<style>
canvas { border:1px solid black;}
#oldcode {font-family: monospace;display: block; white-space: pre;overflow: scroll; margin: 10px;}
.left {float:left; width:49%;}
.right {float:left; left-margin:1%; width:49%;}

</style>
<script src="turtle.js"></script>
<script src="logo.js"></script>
<script src="third/base64.js"></script>
<script src="third/canvas2image.js"></script>

<script>

var turtle = null;
var logo = null;

function init (canvas_id,form_id,oldcode_id) {
    
    var canvas = document.getElementById(canvas_id);
    var form = document.getElementById(form_id);
    
    canvas.width = 500;
    canvas.height = 500;
    
    form.code.style.width = "90%";
    form.code.style.height = "200px";
    
    oldcode = document.getElementById(oldcode_id);
    oldcode.style.width = "90%";
    oldcode.style.height = "300px";
    setup();
}

function setup () {
    logo = new Logo()
    
    fast = 5;
    turtle = new DelayTurtle(canvas,fast);
    logo.setTurtle(turtle);
}

function koch() {
    form.code.value ='\
to line :count :length\n\
ifelse :count = 1 [fw :length] [\n\
make "count :count -1 \n\
line :count :length\n\
lt 60 line :count :length\n\
rt 120 line :count :length\n\
lt 60 line :count :length]\n\
end\n\
\n\
to koch :count :length\n\
rt 30 line :count :length\n\
rt 120 line :count :length\n\
rt 120 line :count :length\n\
end\n\
\n\
reset\n\
setxy  10 400\n\
koch 5 4\n\
';}



function run (speed) {
        if (speed != fast) {
            fast = speed;
            var newturtle = null;
            turtle.stop();
            if (fast == 0) {
                newturtle = new Turtle(canvas);
            } else {
                newturtle = new DelayTurtle(canvas,fast);
            }
            logo.setTurtle(newturtle);
            turtle = newturtle;
        }
        var code = form.code.value;

        oldcode.innerHTML +="\n"+code
        //form.code.value = ""

        
        var out = logo.run(code);
                
        if (out && out.type == "error") {
            alert(out.data);
            setup();
        }
}

function stop(){
    turtle.stop();
}
    
</script>
</head>
<body onload="init('canvas','form','oldcode');">
<div class="left column">
<p><canvas id="canvas" width="500" height="500">
Is broken
</canvas>
</p>
<input type="button" onClick="Canvas2Image.saveAsPNG(canvas)" value="save as png"> 
<pre>
Quick reference logo guide, although please check the google code page for up to date information and more sample programs: <A href="http://code.google.com/p/papert">http://code.google.com/p/papert</a>

Stuff should work in lower or upper case.

Types:

WORDS:          FW BW ....
NUMBERS:        0, 0.1, 20
LISTS:          [1 2 3 5]
SYMBOLS:        "foo "bar
VARIABLES:      :foo :bar 
FUNCTION CALLS: COMMAND arg arg arg ...
                (COMMAND arg arg arg ...)

Supported Commands:

RESET           Clear the screen, move home.


Turtle Movement:

FORWARD n       Move the turtle forward n pixels
FW n    

BACKWARD n      Move the turtle backward n pixels

RIGHT n         Move the turtle left or right n degrees
RT n
LEFT n
LT n

SETX x          Set the co-ordinates of the turtle
SETY y
SETXY x y

HOME            Move the turtle to the home position


Drawing:

CLEARSCREEN     Clear the screen
CLEAR
CS

CIRCLE r        Draw a Circle of radius r around the turtle

ARC r d         Draw an arc of radius r for d degrees

PENUP           Lift the pen up and down
PU
PENDOWN
PD

COLOR [r g b]   Set the pen color

PENWIDTH w      Set the pen width


Arithmetic:

1 + 2                   1 * 2
SUM 1 2                 PRODUCT 1 2
(SUM 1 2 3 ...)         (PRODUCT 1 2 3 ...)

1 - 2                   1 / 2
DIFFERENCE 1 2          DIVIDE 1 2

1 % 2
MOD 1 2

Logical and Comparison:

1 = 1
EQUAL? 1 1
EQUALP 1 1

1 &lt; 2                1 &lt;= 2
LESS? 1 2               LESSEQUAL? 1 2
LESSP 1 2               LESSEQUALP 1 2

2 &gt; 1                2 &gt; 1
GREATER? 2 1            GREATEREQUAL? 2 1
GREATERP 2 1            GREATEREQUALP 2 1

AND TRUE FALSE          OR FALSE TRUE

Conditionals:

IF COND [IF_TRUE] 
IF 2 > 1 [FW 100]

IFELSE COND [IF_TRUE] [IF_FALSE]
IFELSE 2 > 1 [FW 100 RT 90] [BW 100 LT 90]


Setting and getting:

Set x to 1:             make "x 1
Adding :n to :x         :n + :x
Setting :x to :n + :x   make "x :x + :n

Looping:

REPEAT n [COMMANDS ...]

STOP    - Stop the current Repeat or function.

OUTPUT f  - Return f.
OP f


Defining and Calling:

TO FOO :ARG1 :ARG2 BODY END

TO SQUARE :length 
REPEAT 4 [FW :length RT 90]
END

SQUARE :10

TO POLYGON :length :sides
REPEAT :sides [FW :length RT 360/:sides]
END

POLYGON 5 10

Note: Simple Tail recursion is supported.


</pre>
</div>
<div class="right column">
    <form id="form" onSubmit="run(); return false;" action="#">
    <div id="oldcode">&nbsp;</div>
    <div>
    <textarea id="code"></textarea>
    </div>
    <div>
    <input type="button" onClick="run(25);" value="run and draw very slowly"/>
    <input type="button" onClick="run(5);" value="run and draw slowly"/>
    <input type="button" onClick="stop();" value="stop"/>
    <input type="button" onClick="run(0);" value="run  and draw fast"/>
    
    
    <input type="button" value="koch example" onClick="koch()"/>
    </div>
    </form>
</div>

<a href="http://code.google.com/p/papert">papert on google code</a>



</body>
</html>
